{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "sites_SentiaARM_name": {
            "defaultValue": "SentiaARM",
            "type": "String"
        },
        "components_SentiaARM_name": {
            "defaultValue": "SentiaARM",
            "type": "String"
        },
        "availabilitySets_AvSet_name": {
            "defaultValue": "AvSet",
            "type": "String"
        },
        "networkInterfaces_nic0_name": {
            "defaultValue": "nic0",
            "type": "String"
        },
        "networkInterfaces_nic1_name": {
            "defaultValue": "nic1",
            "type": "String"
        },
        "serverfarms_appserviceplan_name": {
            "defaultValue": "appserviceplan",
            "type": "String"
        },
        "virtualMachines_BackendVM0_name": {
            "defaultValue": "BackendVM0",
            "type": "String"
        },
        "virtualMachines_BackendVM1_name": {
            "defaultValue": "BackendVM1",
            "type": "String"
        },
        "loadBalancers_loadbalancer2_name": {
            "defaultValue": "loadbalancer2",
            "type": "String"
        },
        "publicIPAddresses_ipconfig1_name": {
            "defaultValue": "ipconfig1",
            "type": "String"
        },
        "publicIPAddresses_ipconfig2_name": {
            "defaultValue": "ipconfig2",
            "type": "String"
        },
        "storageAccounts_gcui5cyl2zbn4_name": {
            "defaultValue": "gcui5cyl2zbn4",
            "type": "String"
        },
        "virtualNetworks_virtualnetwork_name": {
            "defaultValue": "virtualnetwork",
            "type": "String"
        },
        "alertrules_CPUHigh_appserviceplan_name": {
            "defaultValue": "CPUHigh appserviceplan",
            "type": "String"
        },
        "alertrules_ServerErrors_SentiaARM_name": {
            "defaultValue": "ServerErrors SentiaARM",
            "type": "String"
        },
        "alertrules_ForbiddenRequests_SentiaARM_name": {
            "defaultValue": "ForbiddenRequests SentiaARM",
            "type": "String"
        },
        "alertrules_LongHttpQueue_appserviceplan_name": {
            "defaultValue": "LongHttpQueue appserviceplan",
            "type": "String"
        },
        "autoscalesettings_appserviceplan_ResourceGrp2_name": {
            "defaultValue": "appserviceplan-ResourceGrp2",
            "type": "String"
        },
        "publicIPAddresses_LB_externalid": {
            "defaultValue": "/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp1/providers/Microsoft.Network/publicIPAddresses/LB",
            "type": "String"
        },
        "networkSecurityGroups_vm1_nsg_externalid": {
            "defaultValue": "/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp1/providers/Microsoft.Network/networkSecurityGroups/vm1-nsg",
            "type": "String"
        }
    },
    "variables": {},
    "resources": [
        {
            "type": "microsoft.insights/components",
            "apiVersion": "2015-05-01",
            "name": "[parameters('components_SentiaARM_name')]",
            "location": "eastus",
            "tags": {
                "displayName": "AppInsightsComponent",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/sites/SentiaARM": "Resource"
            },
            "kind": "web",
            "properties": {
                "Application_Type": "web"
            }
        },
        {
            "type": "Microsoft.Network/publicIPAddresses",
            "apiVersion": "2019-06-01",
            "name": "[parameters('publicIPAddresses_ipconfig1_name')]",
            "location": "westeurope",
            "sku": {
                "name": "Standard",
                "tier": "Regional"
            },
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "e10274e4-06ba-4bd6-bf22-0f74b990d192",
                "ipAddress": "51.105.100.39",
                "publicIPAddressVersion": "IPv4",
                "publicIPAllocationMethod": "Static",
                "idleTimeoutInMinutes": 4,
                "ipTags": []
            }
        },
        {
            "type": "Microsoft.Network/publicIPAddresses",
            "apiVersion": "2019-06-01",
            "name": "[parameters('publicIPAddresses_ipconfig2_name')]",
            "location": "westeurope",
            "sku": {
                "name": "Basic",
                "tier": "Regional"
            },
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "f5856f68-e447-4c98-9942-d6170845570e",
                "ipAddress": "51.136.17.173",
                "publicIPAddressVersion": "IPv4",
                "publicIPAllocationMethod": "Dynamic",
                "idleTimeoutInMinutes": 4,
                "ipTags": []
            }
        },
        {
            "type": "Microsoft.Network/virtualNetworks",
            "apiVersion": "2019-06-01",
            "name": "[parameters('virtualNetworks_virtualnetwork_name')]",
            "location": "westeurope",
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "3bae5890-cc56-4d25-bbba-65ab16d25854",
                "addressSpace": {
                    "addressPrefixes": [
                        "10.0.0.0/16"
                    ]
                },
                "subnets": [
                    {
                        "name": "backendSubnet",
                        "etag": "W/\"c76dbccc-701b-4df9-8200-6092b9be094d\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "addressPrefix": "10.0.2.0/24",
                            "networkSecurityGroup": {
                                "id": "[parameters('networkSecurityGroups_vm1_nsg_externalid')]"
                            },
                            "serviceEndpoints": [
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.AzureActiveDirectory",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.AzureCosmosDB",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.ContainerRegistry",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.EventHub",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.KeyVault",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.ServiceBus",
                                    "locations": [
                                        "*"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.Sql",
                                    "locations": [
                                        "westeurope"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.Storage",
                                    "locations": [
                                        "westeurope",
                                        "northeurope"
                                    ]
                                },
                                {
                                    "provisioningState": "Succeeded",
                                    "service": "Microsoft.Web",
                                    "locations": [
                                        "*"
                                    ]
                                }
                            ],
                            "delegations": [],
                            "privateEndpointNetworkPolicies": "Enabled",
                            "privateLinkServiceNetworkPolicies": "Enabled"
                        }
                    }
                ],
                "virtualNetworkPeerings": [],
                "enableDdosProtection": false,
                "enableVmProtection": false
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts",
            "apiVersion": "2019-04-01",
            "name": "[parameters('storageAccounts_gcui5cyl2zbn4_name')]",
            "location": "westeurope",
            "sku": {
                "name": "Standard_LRS",
                "tier": "Standard"
            },
            "kind": "StorageV2",
            "properties": {
                "networkAcls": {
                    "bypass": "AzureServices",
                    "virtualNetworkRules": [],
                    "ipRules": [],
                    "defaultAction": "Allow"
                },
                "supportsHttpsTrafficOnly": false,
                "encryption": {
                    "services": {
                        "file": {
                            "enabled": true
                        },
                        "blob": {
                            "enabled": true
                        }
                    },
                    "keySource": "Microsoft.Storage"
                },
                "accessTier": "Hot"
            }
        },
        {
            "type": "Microsoft.Web/serverfarms",
            "apiVersion": "2016-09-01",
            "name": "[parameters('serverfarms_appserviceplan_name')]",
            "location": "West Europe",
            "tags": {
                "displayName": "HostingPlan"
            },
            "sku": {
                "name": "F1",
                "tier": "Free",
                "size": "F1",
                "family": "F",
                "capacity": 0
            },
            "kind": "app",
            "properties": {
                "name": "[parameters('serverfarms_appserviceplan_name')]",
                "perSiteScaling": false,
                "reserved": false,
                "targetWorkerCount": 0,
                "targetWorkerSizeId": 0
            }
        },
        {
            "type": "microsoft.insights/alertrules",
            "apiVersion": "2014-04-01",
            "name": "[parameters('alertrules_CPUHigh_appserviceplan_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]"
            ],
            "tags": {
                "displayName": "CPUHighAlertRule",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/serverfarms/appserviceplan": "Resource"
            },
            "properties": {
                "name": "[parameters('alertrules_CPUHigh_appserviceplan_name')]",
                "description": "The average CPU is high across all the instances of appserviceplan",
                "isEnabled": false,
                "condition": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition",
                    "dataSource": {
                        "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource",
                        "resourceUri": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]",
                        "metricNamespace": "Microsoft.Web/serverfarms",
                        "metricName": "CpuPercentage"
                    },
                    "operator": "GreaterThan",
                    "threshold": 90,
                    "windowSize": "PT15M"
                },
                "action": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleEmailAction",
                    "sendToServiceOwners": true,
                    "customEmails": []
                }
            }
        },
        {
            "type": "microsoft.insights/alertrules",
            "apiVersion": "2014-04-01",
            "name": "[parameters('alertrules_ForbiddenRequests_SentiaARM_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]"
            ],
            "tags": {
                "displayName": "ForbiddenRequestsAlertRule",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/sites/SentiaARM": "Resource"
            },
            "properties": {
                "name": "[parameters('alertrules_ForbiddenRequests_SentiaARM_name')]",
                "description": "SentiaARM has some requests that are forbidden, status code 403.",
                "isEnabled": false,
                "condition": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition",
                    "dataSource": {
                        "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource",
                        "resourceUri": "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]",
                        "metricNamespace": "Microsoft.Web/sites",
                        "metricName": "Http403"
                    },
                    "operator": "GreaterThan",
                    "threshold": 0,
                    "windowSize": "PT5M"
                },
                "action": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleEmailAction",
                    "sendToServiceOwners": true,
                    "customEmails": []
                }
            }
        },
        {
            "type": "microsoft.insights/alertrules",
            "apiVersion": "2014-04-01",
            "name": "[parameters('alertrules_LongHttpQueue_appserviceplan_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]"
            ],
            "tags": {
                "displayName": "LongHttpQueueAlertRule",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/serverfarms/appserviceplan": "Resource"
            },
            "properties": {
                "name": "[parameters('alertrules_LongHttpQueue_appserviceplan_name')]",
                "description": "The HTTP queue for the instances of appserviceplan has a large number of pending requests.",
                "isEnabled": false,
                "condition": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition",
                    "dataSource": {
                        "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource",
                        "resourceUri": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]",
                        "metricNamespace": "Microsoft.Web/serverfarms",
                        "metricName": "HttpQueueLength"
                    },
                    "operator": "GreaterThan",
                    "threshold": 100,
                    "windowSize": "PT5M"
                },
                "action": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleEmailAction",
                    "sendToServiceOwners": true,
                    "customEmails": []
                }
            }
        },
        {
            "type": "microsoft.insights/alertrules",
            "apiVersion": "2014-04-01",
            "name": "[parameters('alertrules_ServerErrors_SentiaARM_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]"
            ],
            "tags": {
                "displayName": "ServerErrorsAlertRule",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/sites/SentiaARM": "Resource"
            },
            "properties": {
                "name": "[parameters('alertrules_ServerErrors_SentiaARM_name')]",
                "description": "SentiaARM has some server errors, status code 5xx.",
                "isEnabled": false,
                "condition": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.ThresholdRuleCondition",
                    "dataSource": {
                        "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleMetricDataSource",
                        "resourceUri": "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]",
                        "metricNamespace": "Microsoft.Web/sites",
                        "metricName": "Http5xx"
                    },
                    "operator": "GreaterThan",
                    "threshold": 0,
                    "windowSize": "PT5M"
                },
                "action": {
                    "odata.type": "Microsoft.Azure.Management.Insights.Models.RuleEmailAction",
                    "sendToServiceOwners": true,
                    "customEmails": []
                }
            }
        },
        {
            "type": "microsoft.insights/autoscalesettings",
            "apiVersion": "2014-04-01",
            "name": "[parameters('autoscalesettings_appserviceplan_ResourceGrp2_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]"
            ],
            "tags": {
                "displayName": "AutoScaleSettings",
                "hidden-link:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/serverfarms/appserviceplan": "Resource"
            },
            "properties": {
                "profiles": [
                    {
                        "name": "Default",
                        "capacity": {
                            "minimum": "1",
                            "maximum": "2",
                            "default": "1"
                        },
                        "rules": [
                            {
                                "metricTrigger": {
                                    "metricName": "CpuPercentage",
                                    "metricNamespace": "",
                                    "metricResourceUri": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]",
                                    "timeGrain": "PT1M",
                                    "statistic": "Average",
                                    "timeWindow": "PT10M",
                                    "timeAggregation": "Average",
                                    "operator": "GreaterThan",
                                    "threshold": 80,
                                    "dimensions": null,
                                    "dividePerInstance": false
                                },
                                "scaleAction": {
                                    "direction": "Increase",
                                    "type": "ChangeCount",
                                    "value": "1",
                                    "cooldown": "PT10M"
                                }
                            },
                            {
                                "metricTrigger": {
                                    "metricName": "CpuPercentage",
                                    "metricNamespace": "",
                                    "metricResourceUri": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]",
                                    "timeGrain": "PT1M",
                                    "statistic": "Average",
                                    "timeWindow": "PT1H",
                                    "timeAggregation": "Average",
                                    "operator": "LessThan",
                                    "threshold": 60,
                                    "dimensions": null,
                                    "dividePerInstance": false
                                },
                                "scaleAction": {
                                    "direction": "Decrease",
                                    "type": "ChangeCount",
                                    "value": "1",
                                    "cooldown": "PT1H"
                                }
                            }
                        ]
                    }
                ],
                "enabled": false,
                "name": "[parameters('autoscalesettings_appserviceplan_ResourceGrp2_name')]",
                "targetResourceUri": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]"
            }
        },
        {
            "type": "Microsoft.Network/loadBalancers",
            "apiVersion": "2019-06-01",
            "name": "[parameters('loadBalancers_loadbalancer2_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]"
            ],
            "sku": {
                "name": "Basic",
                "tier": "Regional"
            },
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "d2ea40e2-e82e-410d-9867-14394ba2ec4f",
                "frontendIPConfigurations": [
                    {
                        "name": "LoadBalancerFrontend",
                        "etag": "W/\"5fc048fc-dd11-4c0c-9a9c-b69a21c2cdd9\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "privateIPAddress": "10.0.2.6",
                            "privateIPAllocationMethod": "Static",
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]"
                            },
                            "privateIPAddressVersion": "IPv4"
                        }
                    }
                ],
                "backendAddressPools": [
                    {
                        "name": "BackendPool1",
                        "etag": "W/\"5fc048fc-dd11-4c0c-9a9c-b69a21c2cdd9\"",
                        "properties": {
                            "provisioningState": "Succeeded"
                        }
                    }
                ],
                "loadBalancingRules": [
                    {
                        "name": "lbrule",
                        "etag": "W/\"5fc048fc-dd11-4c0c-9a9c-b69a21c2cdd9\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "frontendIPConfiguration": {
                                "id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name')), '/frontendIPConfigurations/LoadBalancerFrontend')]"
                            },
                            "frontendPort": 80,
                            "backendPort": 80,
                            "enableFloatingIP": false,
                            "idleTimeoutInMinutes": 15,
                            "protocol": "Tcp",
                            "enableTcpReset": false,
                            "loadDistribution": "Default",
                            "backendAddressPool": {
                                "id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name')), '/backendAddressPools/BackendPool1')]"
                            },
                            "probe": {
                                "id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name')), '/probes/lbprobe')]"
                            }
                        }
                    }
                ],
                "probes": [
                    {
                        "name": "lbprobe",
                        "etag": "W/\"5fc048fc-dd11-4c0c-9a9c-b69a21c2cdd9\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "protocol": "Tcp",
                            "port": 80,
                            "intervalInSeconds": 15,
                            "numberOfProbes": 2
                        }
                    }
                ],
                "inboundNatRules": [],
                "inboundNatPools": []
            }
        },
        {
            "type": "Microsoft.Network/virtualNetworks/subnets",
            "apiVersion": "2019-06-01",
            "name": "[concat(parameters('virtualNetworks_virtualnetwork_name'), '/backendSubnet')]",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_virtualnetwork_name'))]"
            ],
            "properties": {
                "provisioningState": "Succeeded",
                "addressPrefix": "10.0.2.0/24",
                "networkSecurityGroup": {
                    "id": "[parameters('networkSecurityGroups_vm1_nsg_externalid')]"
                },
                "serviceEndpoints": [
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.AzureActiveDirectory",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.AzureCosmosDB",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.ContainerRegistry",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.EventHub",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.KeyVault",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.ServiceBus",
                        "locations": [
                            "*"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.Sql",
                        "locations": [
                            "westeurope"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.Storage",
                        "locations": [
                            "westeurope",
                            "northeurope"
                        ]
                    },
                    {
                        "provisioningState": "Succeeded",
                        "service": "Microsoft.Web",
                        "locations": [
                            "*"
                        ]
                    }
                ],
                "delegations": [],
                "privateEndpointNetworkPolicies": "Enabled",
                "privateLinkServiceNetworkPolicies": "Enabled"
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/blobServices",
            "apiVersion": "2019-04-01",
            "name": "[concat(parameters('storageAccounts_gcui5cyl2zbn4_name'), '/default')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "cors": {
                    "corsRules": []
                },
                "deleteRetentionPolicy": {
                    "enabled": false
                }
            }
        },
        {
            "type": "Microsoft.Web/sites",
            "apiVersion": "2016-08-01",
            "name": "[parameters('sites_SentiaARM_name')]",
            "location": "West Europe",
            "dependsOn": [
                "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]"
            ],
            "tags": {
                "displayName": "Website",
                "hidden-related:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/serverfarms/appserviceplan": "Resource"
            },
            "kind": "app",
            "properties": {
                "enabled": true,
                "hostNameSslStates": [
                    {
                        "name": "sentiaarm.azurewebsites.net",
                        "sslState": "Disabled",
                        "hostType": "Standard"
                    },
                    {
                        "name": "sentiaarm.scm.azurewebsites.net",
                        "sslState": "Disabled",
                        "hostType": "Repository"
                    }
                ],
                "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', parameters('serverfarms_appserviceplan_name'))]",
                "reserved": false,
                "scmSiteAlsoStopped": false,
                "clientAffinityEnabled": true,
                "clientCertEnabled": false,
                "hostNamesDisabled": false,
                "containerSize": 0,
                "dailyMemoryTimeQuota": 0,
                "httpsOnly": false
            }
        },
        {
            "type": "Microsoft.Web/sites/config",
            "apiVersion": "2016-08-01",
            "name": "[concat(parameters('sites_SentiaARM_name'), '/web')]",
            "location": "West Europe",
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]"
            ],
            "tags": {
                "displayName": "Website",
                "hidden-related:/subscriptions/64f01527-a159-4510-99d3-7d95c360d1a0/resourceGroups/ResourceGrp2/providers/Microsoft.Web/serverfarms/appserviceplan": "Resource"
            },
            "properties": {
                "numberOfWorkers": 1,
                "defaultDocuments": [
                    "Default.htm",
                    "Default.html",
                    "Default.asp",
                    "index.htm",
                    "index.html",
                    "iisstart.htm",
                    "default.aspx",
                    "index.php",
                    "hostingstart.html"
                ],
                "netFrameworkVersion": "v4.0",
                "phpVersion": "5.6",
                "pythonVersion": "",
                "nodeVersion": "",
                "linuxFxVersion": "",
                "requestTracingEnabled": false,
                "remoteDebuggingEnabled": false,
                "httpLoggingEnabled": false,
                "logsDirectorySizeLimit": 35,
                "detailedErrorLoggingEnabled": false,
                "publishingUsername": "$SentiaARM",
                "scmType": "None",
                "use32BitWorkerProcess": true,
                "webSocketsEnabled": false,
                "alwaysOn": false,
                "appCommandLine": "",
                "managedPipelineMode": "Integrated",
                "virtualApplications": [
                    {
                        "virtualPath": "/",
                        "physicalPath": "site\\wwwroot",
                        "preloadEnabled": false,
                        "virtualDirectories": null
                    }
                ],
                "winAuthAdminState": 0,
                "winAuthTenantState": 0,
                "customAppPoolIdentityAdminState": false,
                "customAppPoolIdentityTenantState": false,
                "loadBalancing": "LeastRequests",
                "routingRules": [],
                "experiments": {
                    "rampUpRules": []
                },
                "autoHealEnabled": false,
                "vnetName": "",
                "siteAuthEnabled": false,
                "siteAuthSettings": {
                    "enabled": null,
                    "unauthenticatedClientAction": null,
                    "tokenStoreEnabled": null,
                    "allowedExternalRedirectUrls": null,
                    "defaultProvider": null,
                    "clientId": null,
                    "clientSecret": null,
                    "clientSecretCertificateThumbprint": null,
                    "issuer": null,
                    "allowedAudiences": null,
                    "additionalLoginParams": null,
                    "isAadAutoProvisioned": false,
                    "googleClientId": null,
                    "googleClientSecret": null,
                    "googleOAuthScopes": null,
                    "facebookAppId": null,
                    "facebookAppSecret": null,
                    "facebookOAuthScopes": null,
                    "twitterConsumerKey": null,
                    "twitterConsumerSecret": null,
                    "microsoftAccountClientId": null,
                    "microsoftAccountClientSecret": null,
                    "microsoftAccountOAuthScopes": null
                },
                "localMySqlEnabled": false,
                "http20Enabled": false,
                "minTlsVersion": "1.2",
                "ftpsState": "AllAllowed",
                "reservedInstanceCount": 0,
                "fileChangeAuditEnabled": false
            }
        },
        {
            "type": "Microsoft.Web/sites/hostNameBindings",
            "apiVersion": "2016-08-01",
            "name": "[concat(parameters('sites_SentiaARM_name'), '/', parameters('sites_SentiaARM_name'), '.azurewebsites.net')]",
            "location": "West Europe",
            "dependsOn": [
                "[resourceId('Microsoft.Web/sites', parameters('sites_SentiaARM_name'))]"
            ],
            "properties": {
                "siteName": "SentiaARM",
                "hostNameType": "Verified"
            }
        },
        {
            "type": "Microsoft.Compute/availabilitySets",
            "apiVersion": "2019-03-01",
            "name": "[parameters('availabilitySets_AvSet_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Compute/virtualMachines', parameters('virtualMachines_BackendVM0_name'))]",
                "[resourceId('Microsoft.Compute/virtualMachines', parameters('virtualMachines_BackendVM1_name'))]"
            ],
            "sku": {
                "name": "Aligned"
            },
            "properties": {
                "platformUpdateDomainCount": 2,
                "platformFaultDomainCount": 2,
                "virtualMachines": [
                    {
                        "id": "[resourceId('Microsoft.Compute/virtualMachines', parameters('virtualMachines_BackendVM0_name'))]"
                    },
                    {
                        "id": "[resourceId('Microsoft.Compute/virtualMachines', parameters('virtualMachines_BackendVM1_name'))]"
                    }
                ]
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2019-06-01",
            "name": "[parameters('networkInterfaces_nic0_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]",
                "[resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name'))]"
            ],
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "efc9b1b4-87e0-4263-bfdf-82240a63c1c3",
                "ipConfigurations": [
                    {
                        "name": "ipconfig1",
                        "etag": "W/\"2569a449-c280-4014-b1c1-a6cce767b036\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "privateIPAddress": "10.0.2.4",
                            "privateIPAllocationMethod": "Dynamic",
                            "publicIPAddress": {
                                "id": "[parameters('publicIPAddresses_LB_externalid')]"
                            },
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4",
                            "loadBalancerBackendAddressPools": [
                                {
                                    "id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name')), '/backendAddressPools/BackendPool1')]"
                                }
                            ]
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": [],
                    "appliedDnsServers": [],
                    "internalDomainNameSuffix": "sbmk2o0wzqsu1o30mwvrnusyke.ax.internal.cloudapp.net"
                },
                "macAddress": "00-0D-3A-21-92-AF",
                "enableAcceleratedNetworking": false,
                "enableIPForwarding": false,
                "networkSecurityGroup": {
                    "id": "[parameters('networkSecurityGroups_vm1_nsg_externalid')]"
                },
                "primary": true,
                "tapConfigurations": []
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
            "apiVersion": "2019-04-01",
            "name": "[concat(parameters('storageAccounts_gcui5cyl2zbn4_name'), '/default/bootdiagnostics-backendvm-82ba410b-3818-401a-92a9-f67e6b1d2e48')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccounts_gcui5cyl2zbn4_name'), 'default')]",
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "publicAccess": "None"
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
            "apiVersion": "2019-04-01",
            "name": "[concat(parameters('storageAccounts_gcui5cyl2zbn4_name'), '/default/bootdiagnostics-backendvm-a0161583-8368-49fe-93f8-3d5c182d9706')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccounts_gcui5cyl2zbn4_name'), 'default')]",
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "publicAccess": "None"
            }
        },
        {
            "type": "Microsoft.Storage/storageAccounts/blobServices/containers",
            "apiVersion": "2019-04-01",
            "name": "[concat(parameters('storageAccounts_gcui5cyl2zbn4_name'), '/default/webappstoragedotnet-imagecontainer')]",
            "dependsOn": [
                "[resourceId('Microsoft.Storage/storageAccounts/blobServices', parameters('storageAccounts_gcui5cyl2zbn4_name'), 'default')]",
                "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "publicAccess": "Blob"
            }
        },
        {
            "type": "Microsoft.Compute/virtualMachines",
            "apiVersion": "2019-03-01",
            "name": "[parameters('virtualMachines_BackendVM0_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_AvSet_name'))]",
                "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_nic0_name'))]",
                "[resourceId('Microsoft.Storage/StorageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "availabilitySet": {
                    "id": "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_AvSet_name'))]"
                },
                "hardwareProfile": {
                    "vmSize": "Standard_DS2_V2"
                },
                "storageProfile": {
                    "imageReference": {
                        "publisher": "MicrosoftWindowsServer",
                        "offer": "WindowsServer",
                        "sku": "2016-Datacenter",
                        "version": "latest"
                    },
                    "osDisk": {
                        "osType": "Windows",
                        "name": "[concat(parameters('virtualMachines_BackendVM0_name'), '_OsDisk_1_a54f4abf898341ad9f9c029200082960')]",
                        "createOption": "FromImage",
                        "caching": "ReadWrite",
                        "managedDisk": {
                            "storageAccountType": "Premium_LRS",
                            "id": "[resourceId('Microsoft.Compute/disks', concat(parameters('virtualMachines_BackendVM0_name'), '_OsDisk_1_a54f4abf898341ad9f9c029200082960'))]"
                        },
                        "diskSizeGB": 127
                    },
                    "dataDisks": []
                },
                "osProfile": {
                    "computerName": "[parameters('virtualMachines_BackendVM0_name')]",
                    "adminUsername": "SpDeploy",
                    "windowsConfiguration": {
                        "provisionVMAgent": true,
                        "enableAutomaticUpdates": true
                    },
                    "secrets": []
                },
                "networkProfile": {
                    "networkInterfaces": [
                        {
                            "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_nic0_name'))]"
                        }
                    ]
                },
                "diagnosticsProfile": {
                    "bootDiagnostics": {
                        "enabled": true,
                        "storageUri": "[concat('https://', parameters('storageAccounts_gcui5cyl2zbn4_name'), '.blob.core.windows.net/')]"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Compute/virtualMachines",
            "apiVersion": "2019-03-01",
            "name": "[parameters('virtualMachines_BackendVM1_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_AvSet_name'))]",
                "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_nic1_name'))]",
                "[resourceId('Microsoft.Storage/StorageAccounts', parameters('storageAccounts_gcui5cyl2zbn4_name'))]"
            ],
            "properties": {
                "availabilitySet": {
                    "id": "[resourceId('Microsoft.Compute/availabilitySets', parameters('availabilitySets_AvSet_name'))]"
                },
                "hardwareProfile": {
                    "vmSize": "Standard_DS2_V2"
                },
                "storageProfile": {
                    "imageReference": {
                        "publisher": "MicrosoftWindowsServer",
                        "offer": "WindowsServer",
                        "sku": "2016-Datacenter",
                        "version": "latest"
                    },
                    "osDisk": {
                        "osType": "Windows",
                        "name": "[concat(parameters('virtualMachines_BackendVM1_name'), '_OsDisk_1_f79733b6856441dbadb3e70e7a5153a5')]",
                        "createOption": "FromImage",
                        "caching": "ReadWrite",
                        "managedDisk": {
                            "storageAccountType": "Premium_LRS",
                            "id": "[resourceId('Microsoft.Compute/disks', concat(parameters('virtualMachines_BackendVM1_name'), '_OsDisk_1_f79733b6856441dbadb3e70e7a5153a5'))]"
                        },
                        "diskSizeGB": 127
                    },
                    "dataDisks": []
                },
                "osProfile": {
                    "computerName": "[parameters('virtualMachines_BackendVM1_name')]",
                    "adminUsername": "SpDeploy",
                    "windowsConfiguration": {
                        "provisionVMAgent": true,
                        "enableAutomaticUpdates": true
                    },
                    "secrets": []
                },
                "networkProfile": {
                    "networkInterfaces": [
                        {
                            "id": "[resourceId('Microsoft.Network/networkInterfaces', parameters('networkInterfaces_nic1_name'))]"
                        }
                    ]
                },
                "diagnosticsProfile": {
                    "bootDiagnostics": {
                        "enabled": true,
                        "storageUri": "[concat('https://', parameters('storageAccounts_gcui5cyl2zbn4_name'), '.blob.core.windows.net/')]"
                    }
                }
            }
        },
        {
            "type": "Microsoft.Network/networkInterfaces",
            "apiVersion": "2019-06-01",
            "name": "[parameters('networkInterfaces_nic1_name')]",
            "location": "westeurope",
            "dependsOn": [
                "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_ipconfig2_name'))]",
                "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]",
                "[resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name'))]"
            ],
            "properties": {
                "provisioningState": "Succeeded",
                "resourceGuid": "f777db97-b1b2-4c29-9475-51fa10b225fc",
                "ipConfigurations": [
                    {
                        "name": "ipconfig1",
                        "etag": "W/\"9bc2b24d-40c9-4cfd-8994-4b3c20d36e0b\"",
                        "properties": {
                            "provisioningState": "Succeeded",
                            "privateIPAddress": "10.0.2.5",
                            "privateIPAllocationMethod": "Dynamic",
                            "publicIPAddress": {
                                "id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_ipconfig2_name'))]"
                            },
                            "subnet": {
                                "id": "[resourceId('Microsoft.Network/virtualNetworks/subnets', parameters('virtualNetworks_virtualnetwork_name'), 'backendSubnet')]"
                            },
                            "primary": true,
                            "privateIPAddressVersion": "IPv4",
                            "loadBalancerBackendAddressPools": [
                                {
                                    "id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_loadbalancer2_name')), '/backendAddressPools/BackendPool1')]"
                                }
                            ]
                        }
                    }
                ],
                "dnsSettings": {
                    "dnsServers": [],
                    "appliedDnsServers": [],
                    "internalDomainNameSuffix": "sbmk2o0wzqsu1o30mwvrnusyke.ax.internal.cloudapp.net"
                },
                "macAddress": "00-0D-3A-21-90-44",
                "enableAcceleratedNetworking": false,
                "enableIPForwarding": false,
                "networkSecurityGroup": {
                    "id": "[parameters('networkSecurityGroups_vm1_nsg_externalid')]"
                },
                "primary": true,
                "tapConfigurations": []
            }
        }
    ]
}